

<div class="qm-pannel-container" dir="{{ userDirection$ | async}}" [ngStyle]="{'height':  selectedServiceList && selectedServiceList.length > 0  ? 'calc(100% - 12vh)' : '100%'}">
  <div class="qm-pannel-inner-container"> <div class="qm-flow-sub-header">
  <!--   <div class="qm-flow-sub-header__left"> -->
  <h1 class="qm-text-overflow-fix">{{  (flowType === 'ARRIVE_APPOINTMENT' ? 'edit_service' : 'label.service.heading') | translate}}</h1>
  <div class="qm-selected-box" *ngIf="selectedServiceList && selectedServiceList.length > 0">
    <div class="qm-selected-box__heading">{{ 'label.selected.service' | translate }}</div>

    <div class="qm-flex-wrapper">
      <ng-container *ngFor="let service of selectedServiceList; let rowId = index">
        <div class="qm-selected-box__content-parent">
          <span class="qm-selected-box__bubble">{{rowId + 1}}</span>
          <div class="qm-selected-box__content">
            <div class="qm-selected-box__text">
              {{ service.name && service.name.length > 0 ? service.name : service.internalName }}
            </div>
            <button class="qm-transparent-btn remove-icon">
            <i aria-hidden="true" class="icon-close remove-icon" *ngIf="!service.isBind" (click)="onServiceRemove(service)"></i>
            </button>
          </div>
        </div>
      </ng-container>
    </div>
  </div>

  <div class="qm-service-search-area" >
    <div class="qm-flow-sub-header__left">
      <div class="qm-search qm-search--large" *ngIf="serviceList && serviceList.length >= searchFieldServiceCount">
        <label class="sr-only" for="serviceSearchInput">{{'branch_search_placeholder' | translate}}</label>
        <input [(ngModel)]="searchText" qmClearInput (input)="handleInput($event)" class="qm-search__input ng-pristine ng-valid ng-touched"
          id="serviceSearchInput" name="serviceSearchInput" type="search" placeholder="{{'label.service.search' | translate}}"
          #serviceSearchInput (keydown.enter)="serviceSearchInput.blur()">

        <div *ngIf="(searchText || '').trim().length === 0" class="qm-action-btn qm-action-btn--only-icon qm-search__btn">
          <i aria-hidden="true" class="qm-action-btn__icon icon-search qm-search__icon"></i>
          <span class="sr-only">Search</span>
        </div>
      </div>
    </div>
    <div class="qm-flow-sub-header__right">
      <div class="qm-checkbox__container" *ngIf="multiServiceEnabled">
        <label for="qm-checkbox" class="qm-checkbox-label">
          <input id="qm-checkbox" class="qm-checkbox" type="checkbox" (change)="onSwitchChange()" [(ngModel)]="isMultiServiceOn">
          <div class="qm-checkbox__selector">
            <i aria-hidden="true" class="qm-checkbox__selector-icon"></i>
            <div class="qm-checkbox__selector-icon-text">{{ 'multi_service' | translate }}</div>
          </div>
        </label>
        <button (click)="clickedshowToolTip()" type="button" class="qm-action-btn qm-action-btn--only-icon qm-option__help-btn qm-tooltip-btn">
          <i class="qm-action-btn__icon icon-help" aria-hidden="true"></i>          
        </button>

        <div class="quick-serve-tooltip" *ngIf="showToolTip">
          <div class="triangle"></div>
          <div class="quick-serve-tooltip__rec">
              {{'select_service_tooltip'|translate}}
          </div>
      </div>       
      
      </div>
    </div>
  </div>
  <div class="qm-select-service__search-heading" *ngIf="(searchText || '').trim().length > 0">
      <span>{{'label.search.result.header' | translate}} &nbsp;</span>
      <mark>{{ '"'+ searchText + '"' }}</mark>
      <span class="qm-select-service__foundbox">{{ ' ' + 
          (filteredServiceList | filterService : [filterText, flowType])?.length + ' ' 
          + ((filteredServiceList | filterService : [filterText, flowType])?.length == '1' ? ('label.service.found' | translate) :  ('label.services.found' | translate))
       
      }}
    </span>
  </div>

</div>

<div class="qm-service-list__container" dir="{{ userDirection$ | async }}">

  <div class="qm-service-list__item-container" *ngIf="mostFrequentServiceList && mostFrequentServiceList.length > 0 && (mostFrequentServiceList | filterService: [filterText, flowType]).length > 0">
    <div class="qm-crossline-header-container">
      <div class="qm-crossline-header"></div>
      <h2 class="qm-crossline-header-text qm-text-overflow-fix">{{ 'most_freq_services' | translate }}</h2>
    </div>

    <div class="qm-list">
      <div *ngFor="let service of mostFrequentServiceList | filterService : [filterText, flowType]" class="qm-service-list__item qm-list__item"
         [ngClass]="{'qm-service-list__item--selected, qm-list__item--selected': false}">
        <div tabindex="0" (click)="onServiceSelect(service, true)" (keydown.enter)="onServiceSelect(service, true)" (keydown.space)="onServiceSelect(service, true)" class="qm-service-list__item--text qm-list__item--text qm-list-item--frequent" [ngClass]="{'qm-outline':service.showInfoInMostFrequent}">
        
        <div class="qm-list__item--label" [ngClass]="{'qm-highlight-text': service.showInfoInMostFrequent}">
          {{( service.name && service.name.length > 0 ? service.name : service.internalName)}}
            </div>
              <div class="qm-list__item--info" *ngIf="service.showInfoInMostFrequent">{{service.internalDescription || ('label.noinformation.avaialble' | translate)}}</div>
        </div>
        <i *ngIf="flowType !== 'CREATE_APPOINTMENT' && !service.showInfoInMostFrequent" (click)="service.showInfoInMostFrequent = !service.showInfoInMostFrequent" class="qm-action-btn__icon icon-info" aria-hidden="true"></i>
        <i *ngIf="flowType !== 'CREATE_APPOINTMENT' && service.showInfoInMostFrequent" (click)="service.showInfoInMostFrequent = !service.showInfoInMostFrequent" class="qm-action-btn__icon icon-info-solid" aria-hidden="true"></i>
      
      </div>
    </div>

  </div>
  <div class="qm-service-list__item-container">

    <div class="qm-crossline-header-container">
      <div class="qm-crossline-header"></div>
      <h2 class="qm-crossline-header-text">{{ 'label.service.allservices' | translate }}</h2>
    </div>

    <div class="qm-service-list__header" *ngIf="selectedBranch && filteredServiceList.length === 0 && flowType === 'CREATE_APPOINTMENT'">{{ ('no_bookable_service' | translate) }}</div>

    <div class="qm-list">
      <ng-container *ngFor="let service of filteredServiceList | filterService : [filterText, flowType]">
        <div class="qm-service-list__item qm-list__item"  [ngClass]="{'qm-service-list__item--selected, qm-list__item--selected': false, 'qm-list__item--info-active' : service.showInfo}">

          <div class="qm-service-list__item--text qm-list__item--text" (click)="onServiceSelect(service, true)" [ngClass]="{'qm-outline':service.showInfo}">
            <div class="qm-list__item--label" [ngClass]="{'qm-highlight-text': service.showInfo}" [innerHtml]="( service.name && service.name.length > 0 ? service.name : service.internalName) | qmhighlight: searchText">
            </div>
              <div class="qm-list__item--info" *ngIf="service.showInfo">{{service.internalDescription || ('label.noinformation.avaialble' | translate)}}</div>
          </div>
  
          <i *ngIf="flowType !== 'CREATE_APPOINTMENT' && !service.showInfo" (click)="service.showInfo = !service.showInfo" class="qm-action-btn__icon icon-info" aria-hidden="true"></i>
          <i *ngIf="flowType !== 'CREATE_APPOINTMENT' && service.showInfo" (click)="service.showInfo = !service.showInfo" class="qm-action-btn__icon icon-info-solid" aria-hidden="true"></i>
          
        </div>
      </ng-container>
    </div>
  </div>
</div>
</div></div>
<div class="qm-flow-done-bar" *ngIf="selectedServiceList && selectedServiceList.length > 0">
  <div class="qm-flow-done-bar__done-button" (click)="doneButtonClick()"> {{'banner_done_label' | translate }}</div>
</div>
